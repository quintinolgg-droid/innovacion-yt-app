<div class="d-flex flex-column vh-100">
  <header class="navbar navbar-expand-lg navbar-dark bg-dark shadow-sm">
    <div class="container-fluid">
      <a class="navbar-brand fw-bold" href="#">VideoApp | Dashboard</a>

      <div class="d-flex">
        <!-- Muestra el correo del usuario -->
        <span class="navbar-text me-3 text-info"> Hola, {{ userMail }}</span>

        <button (click)="logOut()" class="btn btn-outline-light btn-sm">
          <i class="bi bi-box-arrow-right"></i> Cerrar Sesi√≥n
        </button>
      </div>
    </div>
  </header>

  <main class="container-fluid flex-grow-1 p-4 bg-light">
    <h2 class="mb-4">√Årea de Videos</h2>

    <ul class="nav nav-tabs" id="myTab" role="tablist">
      <li class="nav-item" role="presentation">
        <button
          class="nav-link active"
          id="videos-tab"
          data-bs-toggle="tab"
          data-bs-target="#videos"
          type="button"
          role="tab"
          aria-controls="videos"
          aria-selected="true"
        >
          üé¨ Videos Disponibles
        </button>
      </li>
      <li class="nav-item" role="presentation">
        <button
          class="nav-link"
          id="favoritos-tab"
          data-bs-toggle="tab"
          data-bs-target="#favoritos"
          type="button"
          role="tab"
          aria-controls="favoritos"
          aria-selected="false"
        >
          ‚≠ê Mis Favoritos
        </button>
      </li>
    </ul>

    <div class="tab-content border border-top-0 bg-white p-3" id="myTabContent">
      <div
        class="tab-pane fade show active"
        id="videos"
        role="tabpanel"
        aria-labelledby="videos-tab"
      >
        <h3 class="mb-3">Listado de Videos</h3>

        <div class="input-group mb-4">
          <input
            type="text"
            class="form-control"
            placeholder="Buscar videos..."
            [ngModel]="searchTermVideos"
            (ngModelChange)="searchTermVideos = $event"
            (keyup.enter)="searchVideos()"
          />
          <button class="btn btn-primary" type="button" (click)="searchVideos()">Buscar</button>
        </div>

        <div *ngIf="!isLoadingVideos">
          <div *ngFor="let video of videos" class="card mb-2 bg-light">
            <div class="card-body d-flex justify-content-between align-items-center">
              <span class="fw-bold">{{ video.title }}</span>

              <button class="btn btn-outline-danger btn-sm" (click)="markAsFavorite(video.videoid)">
                <i class="bi bi-heart"></i> Favorito
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- PESTA√ëA DE FAVORITOS (Implementaci√≥n de *ngFor y *ngIf) -->
      <div class="tab-pane fade" id="favoritos" role="tabpanel" aria-labelledby="favoritos-tab">
        <h3 class="mb-3">Mis Videos Favoritos</h3>

        <div class="input-group mb-4">
          <input
            type="text"
            class="form-control"
            placeholder="Buscar favoritos..."
            [ngModel]="searchTermFavorites"
            (ngModelChange)="searchTermFavorites = $event"
            (keyup.enter)="searchFavorites()"
          />
          <button class="btn btn-primary" type="button" (click)="searchFavorites()">Buscar</button>
        </div>

        <!-- Mensajes de estado -->
        <div *ngIf="isLoadingFavorites" class="alert alert-info">Cargando favoritos...</div>

        <div *ngIf="!isLoadingFavorites && favorites.length === 0" class="alert alert-warning">
          A√∫n no tienes videos guardados como favoritos.
        </div>

        <!-- Lista de Favoritos -->
        <div *ngIf="!isLoadingFavorites">
          <div *ngFor="let fav of favorites" class="card mb-2 bg-light">
            <div class="card-body d-flex justify-content-between align-items-center">
              <span class="fw-bold">{{ fav.title }}</span>

              <button class="btn btn-danger btn-sm" (click)="unmarkAsFavorite(fav.videoid)">
                <i class="bi bi-heart-fill"></i> Desmarcar
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>
